import I from"os";import a from"fs";import u from"crypto";var h=["aes-128-gcm","aes-192-gcm","aes-256-gcm","aes-128-ccm","aes-192-ccm","aes-256-ccm","aes-128-ocb","aes-192-ocb","aes-256-ocb"],b=+process.versions.node.split(".").slice(0,2).join("."),l=Buffer.alloc(16);function B(e,r){return r===void 0||r==="buffer"?e:e.toString(r)}u.randomUUID||(u.randomUUID=function(){let e=u.randomBytes(16).toString("hex");return e.slice(0,8)+"-"+e.slice(8,12)+"-"+e.slice(12,16)+"-"+e.slice(16,20)+"-"+e.slice(-12)});u.randomInt||(u.randomInt=function(e){if(e===void 0)throw new TypeError('[ERR_INVALID_ARG_TYPE]: The "max" argument must be a safe integer. Received undefined');return~~(Math.random()*e)});var p=function(e,r,f){let t=u.createHash(e),i=Buffer.isBuffer(r);return t.update(r,i?"buffer":"utf8"),t.digest(f||"hex")},_=function(e,r,f,t){f=f||"";let i=u.createHmac(e,f),o=Buffer.isBuffer(r);return i.update(r,o?"buffer":"utf8"),i.digest(t||"hex")},v=function(e,r,f=l,t="utf8",i){if(b>=10.5)return g(e,r,f,l,t,i);t=Buffer.isBuffer(r)?"buffer":t;let s=u.createCipher(e,f),n=s.update(r,t);return n=Buffer.concat([n,s.final()]),h.indexOf(e)>-1&&(n=Buffer.concat([n,s.getAuthTag()])),B(n,i)},S=function(e,r,f=l,t="base64",i="utf8"){if(b>=10.5)return x(e,r,f,l,t,i);Buffer.isBuffer(r)||(r=Buffer.from(r,t)),t="buffer";let s=u.createDecipher(e,f);if(h.indexOf(e)>-1){let c=r.slice(-16);r=r.slice(0,-16),s.setAuthTag(c)}let n=s.update(r,t);return n=Buffer.concat([n,s.final()]),B(n,i)},g=function(e,r,f=l,t=l,i="utf8",o){i=Buffer.isBuffer(r)?"buffer":i;let n=u.createCipheriv(e,f,t),c=n.update(r,i);return c=Buffer.concat([c,n.final()]),h.indexOf(e)>-1&&(c=Buffer.concat([c,n.getAuthTag()])),B(c,o)},x=function(e,r,f=l,t=l,i="base64",o="utf8"){Buffer.isBuffer(r)||(r=Buffer.from(r,i)),i="buffer";let n=u.createDecipheriv(e,f,t);if(h.indexOf(e)>-1){let y=r.slice(-16);r=r.slice(0,-16),n.setAuthTag(y)}let c=n.update(r,i);return c=Buffer.concat([c,n.final()]),B(c,o)};var A=function(e){for(let r in e){if(r==="lo")continue;return e[r].pop().mac.replace(/:/g,"").slice(-4)}return Math.random().toString(16).slice(-4)}(I.networkInterfaces()),m=4096;function O(e,r){var f,t;return Buffer.isBuffer(e)?f=e:f=Buffer.from(e+""),t=f.toString("base64"),r?t.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""):t}function d(e,r){return r&&(e=e.replace(/-/g,"+").replace(/_/g,"/").replace(/[^A-Za-z0-9\+\/]/g,"")),Buffer.from(e,"base64")}function D(e,r){let f="qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM0123456789";r&&(f="0123456789");let t=f.length,i="";for(let o=0;o<e;o++)i+=f[u.randomInt(t)];return i}function R(e="-"){var r=u.randomUUID(),f=(~~(Date.now()/1e3)).toString(16);return m>65535&&(m=4096),r=m.toString(16)+r,m++,f+e+A+e+r.slice(0,4)+e+r.slice(-8)}function T(e,r){return typeof e=="number"&&(e+=""),typeof e=="string"||Buffer.isBuffer(e)?p("md5",e,r):e}function U(e){if(a.accessSync(e,a.constants.R_OK)){var r=a.readFileSync(e);return p("md5",r)}return null}function w(e,r){return typeof e=="number"&&(e+=""),typeof e=="string"||Buffer.isBuffer(e)?p("sha1",e,r):e}function K(e){if(a.accessSync(e,a.constants.R_OK)){var r=a.readFileSync(e);return p("sha1",r)}return null}function M(e,r){return typeof e=="number"&&(e+=""),typeof e=="string"||Buffer.isBuffer(e)?p("sha256",e,r):e}function C(e){if(a.accessSync(e,a.constants.R_OK)){var r=a.readFileSync(e);return p("sha256",r)}return null}var j={base64encode:O,base64decode:d,rand:D,uuid:R,md5:T,md5Sign:U,sha1:w,sha1Sign:K,sha256:M,sha256Sign:C,crypto:u,origin:u,hash:p,hmac:_,cipher:v,decipher:S,cipheriv:g,decipheriv:x};export{d as base64decode,O as base64encode,v as cipher,g as cipheriv,u as crypto,S as decipher,x as decipheriv,j as default,p as hash,_ as hmac,T as md5,U as md5Sign,u as origin,D as rand,w as sha1,K as sha1Sign,M as sha256,C as sha256Sign,R as uuid};
